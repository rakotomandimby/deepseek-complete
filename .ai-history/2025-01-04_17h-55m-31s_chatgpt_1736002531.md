# Propose completion from the random sentence generator

The final goal of this project is to be a code completion plugin that uses the DeepSeek API to suggest completions.
But we are not going to implement all in one go.
We are to make it step by step.

## Step 1: Generate a random sentence

in `./lua/rktmb-deepseek-complete.lua`, there is a function called `generate_sentence()`.

That function generates a random sentence.

## Step 2: Suggest a completion from a random sentence when triggered.

I want that when I am in a buffer and in INSERT mode, if I issue the key sequence `<C-c>`,
then the plugin should suggest to complete the current word with a random sentence picked from the list of sentences. The suggestion text must appear in grey.

Tell me what code to put in what file in order to achieve that.




# This is gpt-4o-mini answer (0k in, 0k out)

To achieve the desired functionality of suggesting a random sentence when `<C-c>` is pressed in INSERT mode, you will need to modify both the `lua/rktmb-deepseek-complete.lua` and `plugin/init.lua` files. Below are the complete contents of each file with the necessary code added.

### 1. Update `lua/rktmb-deepseek-complete.lua`

You already have the random sentence generator. We will add a function to handle the completion suggestion.

```lua
-- Initialize a module
local M = {}

-- Function to generate a random sentence
function M.generate_sentence()
  local sentences = {
    "The quick brown fox jumps over the lazy dog.",
    "The five boxing wizards jump quickly.",
    "Pack my box with five dozen liquor jugs.",
    "How vexingly quick daft zebras jump.",
    "Pack my box with five dozen liquor jugs.",
    "How vexingly quick daft zebras jump.",
    "What do you get if you multiply six by nine.",
    "If six is nine, what do you get?",
    "If six is nine, what do you get?",
    "I'm not a number, I'm a free man.",
    "I'm not a number, I'm a free man.",
    "Hey, I'm a free man. What do you get if you multiply six by nine?",
    "Hey, I'm a free man. What do you get if you multiply six by nine?",
  }
  return sentences[math.random(#sentences)]
end

-- Function to suggest a completion
function M.suggest_completion()
  local sentence = M.generate_sentence()
  -- Use the completion API to suggest the sentence
  vim.api.nvim_put({sentence}, 'c', true, true)
end

return M
```

### 2. Update `plugin/init.lua`

Now, we will set up a key mapping to trigger the completion suggestion when `<C-c>` is pressed in INSERT mode.

```lua
-- Load the module
local deepseek = require('rktmb-deepseek-complete')

-- Function to set up key mappings
local function setup_mappings()
  -- Map <C-c> to suggest a completion
  vim.api.nvim_set_keymap('i', '<C-c>', 'v:lua.require("rktmb-deepseek-complete").suggest_completion()', { expr = true, noremap = true, silent = true })
end

-- Call the setup function
setup_mappings()
```

### Summary of Changes

1. **In `lua/rktmb-deepseek-complete.lua`:**
   - Added a new function `suggest_completion()` that generates a random sentence and uses `vim.api.nvim_put()` to insert it into the buffer.

2. **In `plugin/init.lua`:**
   - Set up a key mapping for `<C-c>` in INSERT mode to call the `suggest_completion()` function.

### Final Notes

- Make sure to reload your Neovim configuration or restart Neovim after making these changes.
- The completion text will appear in the default color for inserted text. If you want it to appear in grey, you may need to customize the highlight group for inserted text or use a different method to display the suggestion (like a floating window).

