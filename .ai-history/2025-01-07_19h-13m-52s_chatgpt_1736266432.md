# Propose inline suggestions from DeepSeek API

The final purpose of this project is to be an inline suggestion plugin that uses the DeepSeek API to suggest completions.

I already have some pieces of code.
I need you to generate the missing parts.

## Step 1: Get the text from the beginning of the current buffer to the cursor

The cursor position is a tuple of (row, column), where row is the line number and column is the character position within the line.

Give me the code to get the text from the beginning of the current buffer to the cursor.
Be consistent with the existing code.




# This is gpt-4o-mini answer (1k in, 0k out)

To get the text from the beginning of the current buffer to the cursor, you can create a function that retrieves the current cursor position and then extracts the lines from the buffer up to that position. Below is the code that you can add to your `lua/rktmb-deepseek-complete.lua` file to achieve this:

### Updated `lua/rktmb-deepseek-complete.lua`

```lua
-- Initialize a module
local M = {}

-- Existing functions...

-- Function to get text from the beginning of the current buffer to the cursor
function M.get_text_before_cursor()
  local current_buf = vim.api.nvim_get_current_buf()
  local cursor_pos = vim.api.nvim_win_get_cursor(0)  -- Get the current cursor position
  local row, col = cursor_pos[1] - 1, cursor_pos[2]  -- Adjust for 0-based index

  -- Get lines from the buffer
  local lines = vim.api.nvim_buf_get_lines(current_buf, 0, row + 1, false)  -- Get all lines up to the current line
  local text_before_cursor = table.concat(lines, "\n")  -- Concatenate lines

  -- If we are not at the start of the line, add the part of the current line before the cursor
  if row >= 0 and col > 0 then
    text_before_cursor = text_before_cursor .. "\n" .. lines[row + 1]:sub(1, col)
  end

  return text_before_cursor
end

-- Existing functions...

return M
```

### Explanation
- The `get_text_before_cursor` function retrieves the current buffer and the cursor position.
- It then gets all lines from the start of the buffer to the line where the cursor is located.
- If the cursor is not at the start of the line, it appends the part of the current line that is before the cursor position.
- Finally, it returns the concatenated text.

You can now call this function in your `plugin/init.lua` file to get the text before the cursor when building the request body for the DeepSeek API.

