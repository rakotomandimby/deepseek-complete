# Propose inline suggestions from DeepSeek API

The final purpose of this project is to be an inline suggestion plugin that uses the DeepSeek API to suggest completions.

I already have some pieces of code.
I need you to generate the missing parts.

## Step 1: Get the text from the beginning of the current buffer to the cursor

The cursor position is a tuple of (row, column), where row is the line number and column is the character position within the line.

Give me the code to get the text from the beginning of the current buffer to the cursor.
Be consistent with the existing code.




# This is gemini-exp-1206 answer (2k in, 0k out)

```lua
-- lua/rktmb-deepseek-complete.lua
-- ... (Existing code) ...

function M.get_text_before_cursor()
  local current_line, current_col = vim.api.nvim_win_get_cursor(0)
  local lines = vim.api.nvim_buf_get_lines(0, 0, current_line, false)
  lines[#lines] = string.sub(lines[#lines], 1, current_col)
  return table.concat(lines, "\n")
end


-- ... (Rest of the existing code) ...


```

```lua
-- plugin/init.lua
-- ... (Existing code) ...

local function suggest()
  local current_line, current_col = vim.api.nvim_win_get_cursor(0)
  local text_before_cursor = rktmb_deepseek_complete.get_text_before_cursor()
  local text_after_cursor = rktmb_deepseek_complete.get_text_after_cursor()
  local line_the_cursor_is_on = vim.api.nvim_buf_get_lines(0, current_line -1, current_line, false)[1]

  -- ... (Code to make the request to DeepSeek API using the variables above) ...
end

-- ... (Rest of the existing code) ...

```

In `lua/rktmb-deepseek-complete.lua`, the `M.get_text_before_cursor()` function retrieves the text before the cursor.  It gets the current cursor position, retrieves the lines from the buffer up to the current line, and then truncates the last line to include only the text up to the cursor column.

In `plugin/init.lua`, the `suggest()` function now calls this new function to get the `text_before_cursor`.  I've also added placeholders for getting the text after the cursor and the current line, which you'll need in the next steps.  The code to make the request to the DeepSeek API will also go within this function, using these variables to construct the request body.  You'll need to define `get_text_after_cursor()` in the next step.
