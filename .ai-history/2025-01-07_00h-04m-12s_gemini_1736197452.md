# Use <C-Space> for the inline suggestion

In `./plugin/init.lua`, I tried to unmap any existing keymaps for `<C-Space>` and then mapped it to the function `suggest_random_sentence`.

But the problem is:
- at launch, I get an error "no such mapping"
- when I press `<C-Space>`, the cursor just goes to the next word

Tell me what do I  have to do to have:
- `<C-Space>` mapped to `suggest_random_sentence()`
- `<M-PageDown>` mapped to `accept_suggestion()`





# This is gemini-exp-1206 answer (2k in, 0k out)

The issue lies in how you're attempting to delete the `<C-Space>` keymap.  `vim.api.nvim_del_keymap()` expects a *mode* as its first argument, and a keymap to delete.  You're providing the mode correctly as `"i"` for insert mode, but you're not checking if the mapping exists *before* trying to delete it.  This is why you get the "no such mapping" error on startup if nothing is mapped to `<C-Space>` in insert mode initially.

Here's the corrected `plugin/init.lua`:

```lua
local rktmb_deepseek_complete = require("rktmb-deepseek-complete")
local curl = require('plenary.curl')

-- ... (rest of your code remains the same)

-- Map <C-Space> and <M-PageDown>
local function map_keys()
  -- Check if a mapping exists before deleting
  if vim.api.nvim_get_keymap("i", "<C-Space>").noremap then
    vim.api.nvim_del_keymap("i", "<C-Space>")
  end

  vim.api.nvim_set_keymap("i", "<C-Space>", "<Cmd>lua suggest_random_sentence()<CR>", { noremap = true, silent = true })
  vim.api.nvim_set_keymap("i", "<M-PageDown>", "<Cmd>lua accept_suggestion()<CR>", { noremap = true, silent = true })
end

-- Call the function to map the keys
map_keys()


-- ... (rest of your code remains the same)

```

Key changes:

1. **`map_keys()` function:**  We encapsulate the keymapping logic within a function. This makes it cleaner and allows us to call it at the appropriate time.

2. **Conditional Keymap Deletion:** We use `vim.api.nvim_get_keymap("i", "<C-Space>")` to check if a mapping for `<C-Space>` exists in insert mode. The `.noremap` field will be present if a non-recursive mapping exists. We only delete the mapping if it's found.

3. **Call `map_keys()`:** We call the `map_keys()` function after defining it to ensure the mappings are set up when the plugin loads.


With this change, the "no such mapping" error should be gone, and `<C-Space>` should correctly trigger `suggest_random_sentence()`.  `<M-PageDown>` will also be mapped to `accept_suggestion()`.


No changes are required to your `lua/rktmb-deepseek-complete.lua` file.  It remains as you provided it.

