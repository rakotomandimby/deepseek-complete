# Propose inline suggestions from DeepSeek API

The final purpose of this project is to be an inline suggestion plugin that uses the DeepSeek API to suggest completions.

I already have some pieces of code.
I need you to generate the missing parts.

## Step 1: Get the text from the beginning of the current buffer to the cursor

The cursor position is a tuple of (row, column), where row is the line number and column is the character position within the line.
The code to get the text from the beginning of the current buffer to the cursor is `./lua/rktmb-deepseek-complete.lua` function `M.get_text_before_cursor()`.

## Step 2: Get the text from the cursor to the end of the current buffer

In `./lua/rktmb-deepseek-complete.lua` I created the function `M.get_text_after_cursor()` 
that returns the text from the cursor to the end of the current buffer.

## Step 3: Query the DeepSeek API

When the user presses `<M-ESC>`, the function `suggest()` is called.


# E5560: Vimscript function must not be called in a Lua callback

In `./plugin/init.lua` I have a function `process_deepseek_response()` that is called in the callback of the curl request.
The problem is that the function `process_deepseek_response()` must decode a json string, but it is a vimscript function.

Propose me the changes needed to make to able to decode the json in the response.
I think about using something linke `vim.schedule`, `vim.schedule_wrap`, or any `vim.*` function that could help me.


